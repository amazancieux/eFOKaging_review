---
title: 'Metacognition in the aging brain: are episodic FOK really impaired?'
author: "Audrey Mazancieux"
date: "September 19, 2020"
output:
  html_document: default
  pdf_document: default
---

## Abstract

Decades of research on metacognition in older adults has provided findings suggesting that some aspects of metamemory are impaired in aging. The current review will focus on Feeling-Of-Knowing (FOK), the most studied metamemory judgements in this population, showing a pattern of impaired episodic FOK despite a preserved semantic FOK. We will highlight several methodological issues inerrant in such research confounding participant performance to the memory task itself (i.e., first-order performance) and performance to the metamemory task (i.e., second-order performance). In light of broader work on metacognition, we will propose that the eFOK deficit observed in aging is a consequence of a first-order deficit (also known as the Memory Constraint Hypothesis). We will re-analyse previously published datasets to test our hypothesis using several methods to control for episodic memory performance. We will therefore emphase this caveat in research on metacognition and particular in the context of memory. This is especially important in the context of aging (as well as other population with pathological cognitive impairments) as a metamemory deficit that is the consequence of a first-order deficit suggests that people are nonetheless able to appropriately self-evaluate themselve in daily living and to have adaptive strategies. It also imply that older adults can benefit from training that will likely limit cognitive decline and increase their autonomy.


## Meta-analysis of previous studies

```{r, echo = FALSE}

## Packages and plot theme -----------------------------------------------

library(tidyverse)
library(magrittr)
library(reshape2)
library(metafor)

## Import and arrange data  -------------------------

MetaDF <-read.csv("Data_for_meta.csv", header=TRUE, sep=",", dec=".", fill  = TRUE)

# Exclude read/gen expe
MetaDF %<>%
  filter(Paper != "read/gen")

# Calculate corrected gamma
MetaDF %<>%
  mutate(A_c = ifelse(A == 0, 0.5, A),
         B_c = ifelse(B == 0, 0.5, B),
         C_c = ifelse(C == 0, 0.5, C),
         D_c = ifelse(D == 0, 0.5, D),
         Gamma = ((A_c*D_c - B_c*C_c) / (A_c*D_c + B_c*C_c)),
         Group = ifelse(Group == 1, "Young", "Old"))

# Prepare data fir meta-analysis
Meta_mean <- MetaDF %>% 
  dcast(Paper + recog_type ~ Group, value.var = "Gamma", mean)

Meta_sd <- MetaDF %>% 
  dcast(Paper + recog_type ~ Group, value.var = "Gamma", sd)

Meta_pp <- MetaDF %>% 
  dcast(Paper + recog_type ~ Group, value.var = "Gamma")


## Run meta-analysis using metafor  -------------------------

# Calculate effet size and their variance
Effect <- escalc(n1i = Meta_pp$Young, n2i = Meta_pp$Old, m1i = Meta_mean$Young, m2i = Meta_mean$Old, 
    sd1i = Meta_sd$Young, sd2i = Meta_sd$Old, measure = "SMD", 
    append = TRUE)

# Create model
ma_model <- rma(yi, vi, data = Effect)
summary(ma_model)

```

The overall effect is 0.84 [0.62-1.07] significantly different from 0.
Therefore, corrected gamma corelation for episodic FOK is lower for older aldults compared to young adults. 
There is no heterogeneity in the data Q(df = 5) = 4.8826, p-val = 0.4304. 

#### Forest plot

```{r, echo = FALSE}

# Forest plot
forest(ma_model, slab = Meta_mean$Paper)

```

#### Funnel plot 

```{r, echo = FALSE}

# Funnel plot 
funnel(ma_model)

```
The funnel plot looks symetric indicating likely no publication bias.

However, the calculation of gamma can be biased by episodic recognition task performance. This is particularly the case for extrem low of high performance. Therefore, we aim here to compare metacognitive sensitivity across age group controlling for memory performance. 

## Controling for task performance 

### Use recall as a covariate



### Match sample

```{r, echo = FALSE}

# Calculate median for each group
recall <- MetaDF %>% 
  group_by(Paper, Group) %>% 
  summarise(median = median(Recall))

match <- MetaDF
paper <- unique(MetaDF$Paper)
group <- unique(MetaDF$Group)

for (i in paper) {
  
  for (g in group){
    
    match %<>%
      filter(if (Paper == i & Group == g) Recall <= recall$median[recall$Paper == i & recall$Group == g])
  }
}  

match %<>%
  filter(if (Paper == i & Group == g) Recall <= recall$median[recall$Paper == i & recall$Group == g])
  
```


